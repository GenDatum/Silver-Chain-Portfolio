---
title: "Silver Chain Portfolio"
output: html_document
---

<style>
.g-grid {
  display: flex;
  justify-content: space-between;
  margin-left: -1rem;
  flex-flow: row wrap;
}

.g-grid-cell {
  flex: 1 0;
  background-color: white;
  margin-left: 1rem;
  margin-bottom: 1rem;
  border-style: solid;
  border-color: lightgrey
}

.g-grid-cell:hover {
  border: 2px solid grey;
}

.desc {
    padding: 15px;
    text-align: center;
    border-top: 1px solid lightgrey;
}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r readin, echo=FALSE}
source('initialise_POC_dataset.R')
setwd("C:/Users/81034033/Documents/GitHub/Silver-Chain-Portfolio")

```

## Data Visualisation

This webpage is generated to primarily demonstrate the data visualisations produced utilising Silver Chain's data, with the primary audience being internal and external stakeholders of the Health Care group. A secondary objective is to keep track of these products to facilitate the ease of usage for future projects and reporting purposes. 

Credit: T.B.A

```{r service type by service episodes, echo=FALSE, include=FALSE}
datatab = data.frame(table(data$svc_type))
colnames(datatab)[1] = "Service_Type"

png(file = "Frequency of Service Type Episodes.png", bg = "transparent", width = 1200, height = 1000, res=150)

ggplot(data = datatab, aes(x = Service_Type, y = as.numeric(Freq), fill = Service_Type)) +
	geom_bar(stat = "identity",width = 1) +
	geom_text(aes(y = Freq, label = Freq), size=4, show.legend = FALSE) +
	geom_label(aes(y = Freq, label = Freq), alpha = 0, show.legend = FALSE) +
	coord_polar(theta = "x") +
	guides(fill=guide_legend(title="Service Type")) +
	theme(legend.box.background = element_rect(colour="grey50"), 
		legend.box.margin = margin(6, 6, 6, 6),
		legend.key = element_rect(fill = "white", colour = "black"), 
		legend.title = element_text(face = "bold"),
		plot.title = element_text(face="bold", size = 18),
		panel.background = element_rect(colour = "grey", fill=NA, size=1)) +
	labs(
		y = "Frequency",
		x = "Service Type") +
	theme(axis.text=element_text(size=12,face="bold")) + 
  theme(panel.background = element_rect(fill = "white"),
  plot.margin = margin(2, 2, 2, 2, "cm"))
dev.off()
```

```{r service type by occasions, echo=FALSE, include=FALSE}
datatab.2 = aggregate(Occasions ~ svc_type, data=data, sum, na.rm=TRUE)
colnames(datatab.2)[1] = "Service_Type"

png(file = "Number of Occassions per Service Type.png", bg = "transparent", width = 1200, height = 1000, res=150)

ggplot(data = datatab.2, aes(x = Service_Type, y = as.numeric(Occasions), fill = Service_Type)) +
	geom_bar(stat = "identity",width = 1) +
	geom_text(aes(y = Occasions, label = Occasions), size=4, show.legend = FALSE) +
	geom_label(aes(y = Occasions, label = Occasions), alpha = 0, show.legend = FALSE) +
	coord_polar(theta = "x") +
	guides(fill=guide_legend(title="Service Type")) +
	theme(legend.box.background = element_rect(colour="grey50"), 
		legend.box.margin = margin(6, 6, 6, 6),
		legend.key = element_rect(fill = "white", colour = "black"), 
		legend.title = element_text(face = "bold"),
		plot.title = element_text(face="bold", size = 18),
		panel.background = element_rect(colour = "grey", fill=NA, size=1)) +
	labs(
		y = "Occasions of Service",
		x = "Service Type") +
	theme(axis.text=element_text(size=12,face="bold")) + 
  theme(panel.background = element_rect(fill = "white"),
  plot.margin = margin(2, 2, 2, 2, "cm"))
dev.off()
```

```{r # of occasions, echo=FALSE, include=FALSE}
data$svc_type <- factor(data$svc_type, level = c('PRA', 'CNU', 'PA', 'HATH'))

means = aggregate(Occasions ~ svc_type, data=data, mean)
means$Occasions = round(means$Occasions, 1)

med = aggregate(Occasions ~ svc_type, data=data, median)
med$Occasions = round(med$Occasions, 1)

png(file = "Average Occassions per Service Type.png", bg = "transparent", width = 1200, height = 1000, res=150)

ggplot(data=data, aes(x=svc_type, y=Occasions , fill=svc_type)) + geom_boxplot() + 
	coord_flip(ylim = quantile(data$Occasions, c(0.05, 0.95))) +
  	stat_summary(fun.y=mean, colour="darkred", geom="point", shape=20, size=5, show.legend= FALSE) + 
	labs(
		y = "Occasions of Service",
		x = "Service Type") + 
	guides(fill=guide_legend(title="Service Type")) + 
	theme(axis.text=element_text(size=12,face="bold")) +
	theme(legend.box.background = element_rect(colour="grey50"), 
		legend.box.margin = margin(6, 6, 6, 6),
		legend.key = element_rect(fill = "white", colour = "black"), 
		legend.title = element_text(face = "bold"),
		plot.title = element_text(face="bold", size = 18)) + 
	ggplot2::annotate("text", x = 0.85, y = 18, label = paste("Mean =", means$Occasions[1])) +
	ggplot2::annotate("text", x = 1.15, y = 18, label = paste("Median =", med$Occasions[1])) +
	ggplot2::annotate("text", x = 1.85, y = 18, label = paste("Mean =", means$Occasions[2])) +
	ggplot2::annotate("text", x = 2.15, y = 18, label = paste("Median =", med$Occasions[2])) +
	ggplot2::annotate("text", x = 2.85, y = 18, label = paste("Mean =", means$Occasions[3])) +
	ggplot2::annotate("text", x = 3.15, y = 18, label = paste("Median =", med$Occasions[3])) +
	ggplot2::annotate("text", x = 3.85, y = 18, label = paste("Mean =", means$Occasions[4])) +
	ggplot2::annotate("text", x = 4.15, y = 18, label = paste("Median =", med$Occasions[4])) +
  theme(panel.background = element_rect(fill = "white"),
  plot.margin = margin(2, 2, 2, 2, "cm"))
dev.off()
```


<div class="g-grid">

  <div class="g-grid-cell"><img src="C:/Users/81034033/Documents/GitHub/Silver-Chain-Portfolio/Frequency of Service Type Episodes.png"/>
    <div class="desc">Add a description of the image here</div>
  </div>
  
  <div class="g-grid-cell"><img src="C:/Users/81034033/Documents/GitHub/Silver-Chain-Portfolio/Number of Occassions per Service Type.png"/>
    <div class="desc">Add a description of the image here</div>
  </div>
  
  <div class="g-grid-cell"><img src="C:/Users/81034033/Documents/GitHub/Silver-Chain-Portfolio/Average Occassions per Service Type.png"/>
    <div class="desc">Add a description of the image here</div>
  </div>
</div>

<div class="g-grid">
  <div class="g-grid-cell"><img src="C:/Users/81034033/Documents/GitHub/Silver-Chain-Portfolio/Average Occassions per Service Type.png"/>
    <div class="desc">Add a description of the image here</div>
  </div>
  
  <div class="g-grid-cell"><img src="C:/Users/81034033/Documents/GitHub/Silver-Chain-Portfolio/Number of Occassions per Service Type.png"/>
    <div class="desc">Add a description of the image here</div>
  </div>
  
  <div class="g-grid-cell"><img src="C:/Users/81034033/Documents/GitHub/Silver-Chain-Portfolio/Frequency of Service Type Episodes.png"/>
    <div class="desc">Add a description of the image here</div>
  </div>
</div>


This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.
